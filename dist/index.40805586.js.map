{"mappings":"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","sources":["src/mapkick.js"],"sourcesContent":["/*\r\n * Mapkick.js v0.2.6\r\n * Create beautiful, interactive maps with one line of JavaScript\r\n * https://github.com/ankane/mapkick.js\r\n * MIT License\r\n */\r\n\r\n(function (global, factory) {\r\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n  typeof define === 'function' && define.amd ? define(factory) :\r\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.Mapkick = factory());\r\n})(this, (function () { 'use strict';\r\n\r\n  function getElement(element) {\r\n    if (typeof element === \"string\") {\r\n      var elementId = element;\r\n      element = document.getElementById(element);\r\n      if (!element) {\r\n        throw new Error(\"No element with id \" + elementId)\r\n      }\r\n    }\r\n    return element\r\n  }\r\n\r\n  // check for hex or named color\r\n  function validateColor(color) {\r\n    if (!/^#([0-9a-f]{3}){1,2}$/i.test(color) && !/^[a-z]+$/i.test(color)) {\r\n      throw new Error(\"Invalid color\")\r\n    }\r\n  }\r\n\r\n  function createMarkerImage(library, color) {\r\n    // set height to center vertically\r\n    var height = 41;\r\n    var width = 27;\r\n    var scale = 2;\r\n\r\n    // get marker svg\r\n    var svg = (new library.Marker())._element.querySelector(\"svg\");\r\n\r\n    // make displayable and center vertically\r\n    svg.removeAttribute(\"display\");\r\n    svg.setAttribute(\"xmlns\", \"http://www.w3.org/2000/svg\");\r\n    svg.setAttribute(\"height\", height);\r\n    svg.setAttribute(\"width\", width);\r\n    svg.setAttribute(\"viewBox\", (\"0 0 \" + width + \" \" + height));\r\n\r\n    validateColor(color);\r\n\r\n    // set color\r\n    svg.querySelector(\"*[fill='#3FB1CE']\").setAttribute(\"fill\", color);\r\n\r\n    // add border to inner circle\r\n    var circles = svg.querySelectorAll(\"circle\");\r\n    var circle = circles[circles.length - 1];\r\n    if (circles.length == 1) {\r\n      // need to insert new circle for mapbox-gl v2\r\n      var c = circle.cloneNode();\r\n      c.setAttribute(\"fill\", \"#000000\");\r\n      c.setAttribute(\"opacity\", 0.25);\r\n      circle.parentNode.insertBefore(c, circle);\r\n    }\r\n    circle.setAttribute(\"r\", 4.5);\r\n\r\n    // create image\r\n    var image = new Image(width * scale, height * scale);\r\n    image.src = \"data:image/svg+xml;utf8,\" + (encodeURIComponent(svg.outerHTML));\r\n    return image\r\n  }\r\n\r\n  var maps = {};\r\n\r\n  var BaseMap = function BaseMap(element, data, options, mapType) {\r\n    var this$1$1 = this;\r\n\r\n    if (!Mapkick.library && typeof window !== \"undefined\") {\r\n      Mapkick.library = window.mapboxgl || window.maplibregl || null;\r\n    }\r\n\r\n    var library = Mapkick.library;\r\n    if (!library) {\r\n      throw new Error(\"No mapping library found\")\r\n    }\r\n\r\n    var map;\r\n    var trails = {};\r\n    var groupedData = {};\r\n    var timestamps = [];\r\n    var timeIndex = 0;\r\n\r\n    element = getElement(element);\r\n\r\n    if (element.id) {\r\n      maps[element.id] = this;\r\n    }\r\n\r\n    function getJSON(element, url, success) {\r\n      var xhr = new XMLHttpRequest();\r\n      xhr.open(\"GET\", url, true);\r\n      xhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n      xhr.onload = function () {\r\n        if (xhr.status === 200) {\r\n          success(JSON.parse(xhr.responseText));\r\n        } else {\r\n          showError(element, xhr.statusText);\r\n        }\r\n      };\r\n      xhr.send();\r\n    }\r\n\r\n    function onMapLoad(callback) {\r\n      if (map.loaded()) {\r\n        callback();\r\n      } else {\r\n        map.on(\"load\", callback);\r\n      }\r\n    }\r\n\r\n    function toTimestamp(ts) {\r\n      if (typeof ts === \"number\") {\r\n        return ts\r\n      } else {\r\n        return (new Date(ts)).getTime() / 1000\r\n      }\r\n    }\r\n\r\n    function generateReplayMap(element, data, options) {\r\n      // group data\r\n      for (var i = 0; i < data.length; i++) {\r\n        var row = data[i];\r\n        var ts = toTimestamp(row.time);\r\n        if (ts) {\r\n          if (!groupedData[ts]) {\r\n            groupedData[ts] = [];\r\n          }\r\n          groupedData[ts].push(row);\r\n          bounds.extend(rowCoordinates(row));\r\n        }\r\n      }\r\n\r\n      for (var i$1 in groupedData) {\r\n        if (Object.prototype.hasOwnProperty.call(groupedData, i$1)) {\r\n          timestamps.push(parseInt(i$1));\r\n        }\r\n      }\r\n      timestamps.sort();\r\n\r\n      // create map\r\n      generateMap(element, groupedData[timestamps[timeIndex]], options);\r\n\r\n      onMapLoad(function () {\r\n        setTimeout(function () {\r\n          nextFrame(element, options);\r\n        }, 100);\r\n      });\r\n    }\r\n\r\n    function nextFrame(element, options) {\r\n      timeIndex++;\r\n\r\n      updateMap(element, groupedData[timestamps[timeIndex]], options);\r\n\r\n      if (timeIndex < timestamps.length - 1) {\r\n        setTimeout(function () {\r\n          nextFrame(element, options);\r\n        }, 100);\r\n      }\r\n    }\r\n\r\n    function showError(element, message) {\r\n      element.textContent = message;\r\n    }\r\n\r\n    function errorCatcher(element, data, options, callback) {\r\n      try {\r\n        callback(element, data, options);\r\n      } catch (err) {\r\n        showError(element, err.message);\r\n        throw err\r\n      }\r\n    }\r\n\r\n    function fetchData(element, data, options, callback) {\r\n      if (typeof data === \"string\") {\r\n        getJSON(element, data, function (newData) {\r\n          errorCatcher(element, newData, options, callback);\r\n        });\r\n      } else if (typeof data === \"function\") {\r\n        data(function (newData) {\r\n          errorCatcher(element, newData, options, callback);\r\n        }, function (message) {\r\n          showError(element, message);\r\n        });\r\n      } else {\r\n        errorCatcher(element, data, options, callback);\r\n      }\r\n    }\r\n\r\n    function updateMap(element, data, options) {\r\n      onLayersReady(function () {\r\n        if (options.trail) {\r\n          recordTrails(data, options.trail);\r\n          map.getSource(\"trails\").setData(generateTrailsGeoJSON(data));\r\n        }\r\n        map.getSource(\"objects\").setData(generateGeoJSON(data, options));\r\n      });\r\n    }\r\n\r\n    // use Map instead of object for security\r\n    var markerIds = new window.Map();\r\n\r\n    function generateGeoJSON(data, options) {\r\n      var geojson = {\r\n        type: \"FeatureCollection\",\r\n        features: []\r\n      };\r\n\r\n      for (var i = 0; i < data.length; i++) {\r\n        var row = data[i];\r\n        var properties = Object.assign({}, row);\r\n        var geometry = (void 0);\r\n\r\n        if (mapType === \"point\") {\r\n          if (!properties.icon) {\r\n            properties.icon = options.defaultIcon || \"mapkick\";\r\n          }\r\n          properties.mapkickIconSize = properties.icon === \"mapkick\" ? 0.5 : 1;\r\n          properties.mapkickIconAnchor = properties.icon === \"mapkick\" ? \"bottom\" : \"center\";\r\n          properties.mapkickIconOffset = properties.icon === \"mapkick\" ? [0, 10] : [0, 0];\r\n\r\n          if (properties.icon === \"mapkick\") {\r\n            var color = properties.color || markerOptions.color || \"#f84d4d\";\r\n\r\n            var markerId = markerIds.get(color);\r\n            if (markerId === undefined) {\r\n              markerId = markerIds.size;\r\n              validateColor(color);\r\n              markerIds.set(color, markerId);\r\n            }\r\n\r\n            properties.icon = \"mapkick-\" + markerId;\r\n          }\r\n\r\n          var coordinates = rowCoordinates(row);\r\n\r\n          if (!coordinates[1]) {\r\n            throw new Error((\"missing latitude (index: \" + i + \")\"))\r\n          }\r\n\r\n          if (!coordinates[0]) {\r\n            throw new Error((\"missing longitude (index: \" + i + \")\"))\r\n          }\r\n\r\n          geometry = {\r\n            type: \"Point\",\r\n            coordinates: coordinates\r\n          };\r\n        } else {\r\n          geometry = row.geometry;\r\n\r\n          if (!geometry) {\r\n            throw new Error((\"missing geometry (index: \" + i + \")\"))\r\n          }\r\n\r\n          delete properties.geometry;\r\n\r\n          properties.mapkickColor = properties.color || markerOptions.color || \"#0090ff\";\r\n\r\n        }\r\n\r\n        geojson.features.push({\r\n          type: \"Feature\",\r\n          id: i,\r\n          geometry: geometry,\r\n          properties: properties\r\n        });\r\n      }\r\n\r\n      return geojson\r\n    }\r\n\r\n    function rowCoordinates(row) {\r\n      return [row.longitude || row.lng || row.lon, row.latitude || row.lat]\r\n    }\r\n\r\n    function getTrailId(row) {\r\n      return row.id\r\n    }\r\n\r\n    function recordTrails(data, trailOptions) {\r\n      for (var i = 0; i < data.length; i++) {\r\n        var row = data[i];\r\n        var trailId = getTrailId(row);\r\n        if (!trails[trailId]) {\r\n          trails[trailId] = [];\r\n        }\r\n        trails[trailId].push(rowCoordinates(row));\r\n        if (trailOptions && trailOptions.len && trails[trailId].length > trailOptions.len) {\r\n          trails[trailId].shift();\r\n        }\r\n      }\r\n    }\r\n\r\n    function generateTrailsGeoJSON(data) {\r\n      var geojson = {\r\n        type: \"FeatureCollection\",\r\n        features: []\r\n      };\r\n\r\n      for (var i = 0; i < data.length; i++) {\r\n        var row = data[i];\r\n        geojson.features.push({\r\n          type: \"Feature\",\r\n          geometry: {\r\n            type: \"LineString\",\r\n            coordinates: trails[getTrailId(row)]\r\n          }\r\n        });\r\n      }\r\n\r\n      return geojson\r\n    }\r\n\r\n    function generateLabelGeoJSON(data) {\r\n      var geojson = {\r\n        type: \"FeatureCollection\",\r\n        features: []\r\n      };\r\n\r\n      for (var i = 0; i < data.features.length; i++) {\r\n        var feature = data.features[i];\r\n        var coordinates = (void 0);\r\n\r\n        // use center for now\r\n        var bounds = new library.LngLatBounds();\r\n        extendBounds(bounds, feature.geometry);\r\n        if (!bounds.isEmpty()) {\r\n          var center = bounds.getCenter();\r\n          coordinates = [center.lng, center.lat];\r\n        }\r\n\r\n        if (coordinates) {\r\n          geojson.features.push({\r\n            type: \"Feature\",\r\n            id: i,\r\n            geometry: {\r\n              type: \"Point\",\r\n              coordinates: coordinates\r\n            },\r\n            properties: feature.properties\r\n          });\r\n        }\r\n      }\r\n\r\n      return geojson\r\n    }\r\n\r\n    function layerBeforeFill(map) {\r\n      // place below labels\r\n      var layers = map.getStyle().layers;\r\n      var beforeId;\r\n      for (var i = layers.length - 1; i >= 0; i--) {\r\n        var layer = layers[i];\r\n        // TODO improve\r\n        if (!(layer.metadata && layer.metadata[\"mapbox:featureComponent\"] === \"place-labels\")) {\r\n          break\r\n        }\r\n        beforeId = layer.id;\r\n      }\r\n      return beforeId\r\n    }\r\n\r\n    function addLayer(name, geojson) {\r\n      var centersById = {};\r\n\r\n      map.addSource(name, {\r\n        type: \"geojson\",\r\n        data: geojson\r\n      });\r\n\r\n      if (mapType === \"point\") {\r\n        // use a symbol layer for markers for performance\r\n        // https://docs.mapbox.com/help/getting-started/add-markers/#approach-1-adding-markers-inside-a-map\r\n        // use separate layers to prevent labels from overlapping markers\r\n        map.addLayer({\r\n          id: (name + \"-text\"),\r\n          source: name,\r\n          type: \"symbol\",\r\n          layout: {\r\n            \"text-field\": \"{label}\",\r\n            \"text-size\": 11,\r\n            \"text-anchor\": \"top\",\r\n            \"text-offset\": [0, 1]\r\n          },\r\n          paint: {\r\n            \"text-halo-color\": \"rgba(255, 255, 255, 1)\",\r\n            \"text-halo-width\": 1\r\n          }\r\n        });\r\n        map.addLayer({\r\n          id: name,\r\n          source: name,\r\n          type: \"symbol\",\r\n          layout: {\r\n            \"icon-image\": \"{icon}-15\",\r\n            \"icon-allow-overlap\": true,\r\n            \"icon-size\": {type: \"identity\", property: \"mapkickIconSize\"},\r\n            \"icon-anchor\": {type: \"identity\", property: \"mapkickIconAnchor\"},\r\n            \"icon-offset\": {type: \"identity\", property: \"mapkickIconOffset\"}\r\n          }\r\n        });\r\n      } else {\r\n        var beforeId = layerBeforeFill(map);\r\n\r\n        var outlineId = name + \"-outline\";\r\n        map.addLayer({\r\n          id: outlineId,\r\n          source: name,\r\n          type: \"line\",\r\n          paint: {\r\n            \"line-color\": {type: \"identity\", property: \"mapkickColor\"},\r\n            \"line-opacity\": 0.7,\r\n            \"line-width\": 1\r\n          }\r\n        }, beforeId);\r\n\r\n        map.addLayer({\r\n          id: name,\r\n          source: name,\r\n          type: \"fill\",\r\n          paint: {\r\n            \"fill-color\": {type: \"identity\", property: \"mapkickColor\"},\r\n            \"fill-opacity\": 0.3\r\n          }\r\n        }, outlineId);\r\n\r\n        var labelName = name + \"-text\";\r\n        var labelData = generateLabelGeoJSON(geojson);\r\n\r\n        for (var i = 0; i < labelData.features.length; i++) {\r\n          var feature = labelData.features[i];\r\n          centersById[feature.id] = feature.geometry.coordinates;\r\n        }\r\n\r\n        map.addSource(labelName, {\r\n          type: \"geojson\",\r\n          data: labelData\r\n        });\r\n\r\n        map.addLayer({\r\n          id: (name + \"-text\"),\r\n          source: labelName,\r\n          type: \"symbol\",\r\n          layout: {\r\n            \"text-field\": \"{label}\",\r\n            \"text-size\": 11\r\n          },\r\n          paint: {\r\n            \"text-halo-color\": \"rgba(255, 255, 255, 1)\",\r\n            \"text-halo-width\": 1\r\n          }\r\n        });\r\n      }\r\n\r\n      var hover = !(\"hover\" in tooltipOptions) || tooltipOptions.hover;\r\n\r\n      var popupOptions = {\r\n        closeButton: false,\r\n        closeOnClick: false\r\n      };\r\n      if (!hover) {\r\n        popupOptions.anchor = \"bottom\";\r\n      }\r\n\r\n      // create a popup\r\n      var popup = new library.Popup(popupOptions);\r\n\r\n      // ensure tooltip is visible\r\n      var panMap = function (map, popup) {\r\n        var style = window.getComputedStyle(popup.getElement());\r\n        var matrix = new DOMMatrixReadOnly(style.transform);\r\n        var padding = 5;\r\n        var extra = 5;\r\n        var top = matrix.m42;\r\n        var left = matrix.m41;\r\n\r\n        // TODO add right and bottom\r\n        if (top < padding || left < padding) {\r\n          map.panBy([Math.min(left - padding - extra, 0), Math.min(top - padding - extra, 0)]);\r\n        }\r\n      };\r\n\r\n      var showPopup = function (e) {\r\n        var feature = selectedFeature(e);\r\n        var tooltip = feature.properties.tooltip;\r\n\r\n        if (!tooltip) {\r\n          return\r\n        }\r\n\r\n        if (mapType === \"point\" && feature.properties.icon.startsWith(\"mapkick-\")) {\r\n          popup.options.offset = {\r\n            \"top\": [0, 14],\r\n            \"top-left\": [0, 14],\r\n            \"top-right\": [0, 14],\r\n            \"bottom\": [0, -44],\r\n            \"bottom-left\": [0, -44],\r\n            \"bottom-right\": [0, -44],\r\n            \"left\": [14, 0],\r\n            \"right\": [-14, 0]\r\n          };\r\n        } else {\r\n          popup.options.offset = 14;\r\n        }\r\n\r\n        var coordinates;\r\n        if (mapType === \"point\") {\r\n          coordinates = feature.geometry.coordinates;\r\n        } else {\r\n          coordinates = centersById[feature.id];\r\n        }\r\n\r\n        // add the tooltip\r\n        popup.setLngLat(coordinates);\r\n        if (tooltipOptions.html) {\r\n          popup.setHTML(tooltip);\r\n        } else {\r\n          popup.setText(tooltip);\r\n        }\r\n        popup.addTo(map);\r\n\r\n        // fix blurriness for non-retina screens\r\n        // https://github.com/mapbox/mapbox-gl-js/pull/3258\r\n        if (popup._container.offsetWidth % 2 !== 0) {\r\n          popup._container.style.width = popup._container.offsetWidth + 1 + \"px\";\r\n        }\r\n\r\n        if (mapType !== \"area\") {\r\n          panMap(map, popup);\r\n        }\r\n      };\r\n\r\n      var getLatitude = function (feature) {\r\n        return feature.geometry.coordinates[1]\r\n      };\r\n\r\n      var selectedFeature = function (e) {\r\n        var features = e.features;\r\n        var selected = features[0];\r\n        for (var i = 1; i < features.length; i++) {\r\n          var feature = features[i];\r\n          // no need to handle ties since this is stable\r\n          if (getLatitude(feature) < getLatitude(selected)) {\r\n            selected = feature;\r\n          }\r\n        }\r\n        return selected\r\n      };\r\n\r\n      if (!hover) {\r\n        var currentPoint = null;\r\n\r\n        map.on(\"click\", name, function (e) {\r\n          var point = selectedFeature(e).id;\r\n          if (point !== currentPoint) {\r\n            showPopup(e);\r\n            currentPoint = point;\r\n            e.mapkickPopupOpened = true;\r\n          }\r\n        });\r\n\r\n        map.on(\"click\", function (e) {\r\n          if (!e.mapkickPopupOpened) {\r\n            popup.remove();\r\n            currentPoint = null;\r\n          }\r\n        });\r\n      }\r\n\r\n      map.on(\"mouseenter\", name, function (e) {\r\n        var tooltip = selectedFeature(e).properties.tooltip;\r\n\r\n        if (tooltip) {\r\n          map.getCanvas().style.cursor = \"pointer\";\r\n\r\n          if (hover) {\r\n            showPopup(e);\r\n          }\r\n        }\r\n      });\r\n\r\n      map.on(\"mouseleave\", name, function () {\r\n        map.getCanvas().style.cursor = \"\";\r\n\r\n        if (hover) {\r\n          popup.remove();\r\n        }\r\n      });\r\n    }\r\n\r\n    function extendBounds(bounds, geometry) {\r\n      if (geometry.type === \"Point\") {\r\n        bounds.extend(geometry.coordinates);\r\n      } else if (geometry.type === \"Polygon\") {\r\n        var coordinates = geometry.coordinates[0];\r\n        for (var j = 0; j < coordinates.length; j++) {\r\n          bounds.extend(coordinates[j]);\r\n        }\r\n      } else if (geometry.type === \"MultiPolygon\") {\r\n        var coordinates$1 = geometry.coordinates;\r\n        for (var j$1 = 0; j$1 < coordinates$1.length; j$1++) {\r\n          var polygon = coordinates$1[j$1][0];\r\n          for (var k = 0; k < polygon.length; k++) {\r\n            bounds.extend(polygon[k]);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    var generateMap = function (element, data, options) {\r\n      var geojson = generateGeoJSON(data, options);\r\n      options = options || {};\r\n\r\n      for (var i = 0; i < geojson.features.length; i++) {\r\n        extendBounds(bounds, geojson.features[i].geometry);\r\n      }\r\n\r\n      // remove any child elements\r\n      element.textContent = \"\";\r\n\r\n      var style = options.style;\r\n      if (!style) {\r\n        var isMapLibre = !(\"accessToken\" in library) || /^1\\.1[45]/.test(library.version);\r\n        if (isMapLibre) {\r\n          throw new Error(\"style required for MapLibre\")\r\n        } else {\r\n          style = \"mapbox://styles/mapbox/streets-v12\";\r\n        }\r\n      }\r\n\r\n      var zoom = options.zoom;\r\n      var center = options.center;\r\n      if (!center) {\r\n        if (!bounds.isEmpty()) {\r\n          center = bounds.getCenter();\r\n        } else {\r\n          center = [0, 0];\r\n          if (!zoom) {\r\n            zoom = 1;\r\n          }\r\n        }\r\n      }\r\n      if (!zoom) {\r\n        zoom = 15;\r\n      }\r\n\r\n      var mapOptions = {\r\n        container: element,\r\n        style: style,\r\n        dragRotate: false,\r\n        touchZoomRotate: false,\r\n        center: center,\r\n        zoom: zoom\r\n      };\r\n      if (!options.style) {\r\n        mapOptions.projection = \"mercator\";\r\n      }\r\n      if (options.accessToken) {\r\n        mapOptions.accessToken = options.accessToken;\r\n      }\r\n      if (options.library) {\r\n        Object.assign(mapOptions, options.library);\r\n      }\r\n      map = new library.Map(mapOptions);\r\n\r\n      if (options.controls) {\r\n        map.addControl(new library.NavigationControl({showCompass: false}));\r\n      }\r\n\r\n      if (!options.zoom) {\r\n        // hack to prevent error\r\n        if (!map.style.stylesheet) {\r\n          map.style.stylesheet = {};\r\n        }\r\n\r\n        // check zoom for hash library option\r\n        if (!bounds.isEmpty() && map.getZoom() === zoom) {\r\n          map.fitBounds(bounds, {padding: 40, animate: false, maxZoom: 15});\r\n        }\r\n      }\r\n\r\n      this$1$1.map = map;\r\n\r\n      onMapLoad(function () {\r\n        if (options.trail) {\r\n          recordTrails(data);\r\n\r\n          map.addSource(\"trails\", {\r\n            type: \"geojson\",\r\n            data: generateTrailsGeoJSON([])\r\n          });\r\n\r\n          map.addLayer({\r\n            id: \"trails\",\r\n            source: \"trails\",\r\n            type: \"line\",\r\n            layout: {\r\n              \"line-join\": \"round\",\r\n              \"line-cap\": \"round\"\r\n            },\r\n            paint: {\r\n              \"line-color\": \"#888\",\r\n              \"line-width\": 2\r\n            }\r\n          });\r\n        }\r\n\r\n        var outstanding = markerIds.size;\r\n\r\n        function checkReady() {\r\n          if (outstanding !== 0) {\r\n            outstanding--;\r\n            return\r\n          }\r\n\r\n          addLayer(\"objects\", geojson);\r\n\r\n          layersReady = true;\r\n          var cb;\r\n          while ((cb = layersReadyQueue.shift())) {\r\n            cb();\r\n          }\r\n        }\r\n\r\n        // load marker images\r\n        markerIds.forEach(function (id, color) {\r\n          var image = createMarkerImage(library, color);\r\n          image.addEventListener(\"load\", function () {\r\n            map.addImage((\"mapkick-\" + id + \"-15\"), image);\r\n            checkReady();\r\n          });\r\n        });\r\n\r\n        checkReady();\r\n      });\r\n    };\r\n\r\n    var layersReady = false;\r\n    var layersReadyQueue = [];\r\n    function onLayersReady(callback) {\r\n      if (layersReady) {\r\n        callback();\r\n      } else {\r\n        layersReadyQueue.push(callback);\r\n      }\r\n    }\r\n\r\n    // main\r\n\r\n    options = options || {};\r\n    options = Object.assign({}, Mapkick.options, options);\r\n    var tooltipOptions = options.tooltips || {};\r\n    var markerOptions = options.markers || {};\r\n    var bounds = new library.LngLatBounds();\r\n\r\n    if (options.replay) {\r\n      fetchData(element, data, options, generateReplayMap);\r\n    } else {\r\n      fetchData(element, data, options, generateMap);\r\n\r\n      if (options.refresh) {\r\n        this.intervalId = setInterval(function () {\r\n          fetchData(element, data, options, updateMap);\r\n        }, options.refresh * 1000);\r\n      }\r\n    }\r\n  };\r\n\r\n  BaseMap.prototype.getMapObject = function getMapObject () {\r\n    return this.map\r\n  };\r\n\r\n  BaseMap.prototype.destroy = function destroy () {\r\n    this.stopRefresh();\r\n\r\n    if (this.map) {\r\n      this.map.remove();\r\n      this.map = null;\r\n    }\r\n  };\r\n\r\n  BaseMap.prototype.stopRefresh = function stopRefresh () {\r\n    if (this.intervalId) {\r\n      clearInterval(this.intervalId);\r\n      this.intervalId = null;\r\n    }\r\n  };\r\n\r\n  var Map = /*@__PURE__*/(function (BaseMap) {\r\n    function Map(element, data, options) {\r\n      BaseMap.call(this, element, data, options, \"point\");\r\n    }\r\n\r\n    if ( BaseMap ) Map.__proto__ = BaseMap;\r\n    Map.prototype = Object.create( BaseMap && BaseMap.prototype );\r\n    Map.prototype.constructor = Map;\r\n\r\n    return Map;\r\n  }(BaseMap));\r\n\r\n  var AreaMap = /*@__PURE__*/(function (BaseMap) {\r\n    function AreaMap(element, data, options) {\r\n      BaseMap.call(this, element, data, options, \"area\");\r\n    }\r\n\r\n    if ( BaseMap ) AreaMap.__proto__ = BaseMap;\r\n    AreaMap.prototype = Object.create( BaseMap && BaseMap.prototype );\r\n    AreaMap.prototype.constructor = AreaMap;\r\n\r\n    return AreaMap;\r\n  }(BaseMap));\r\n\r\n  var Mapkick = {\r\n    Map: Map,\r\n    AreaMap: AreaMap,\r\n    maps: maps,\r\n    options: {},\r\n    library: null\r\n  };\r\n\r\n  Mapkick.use = function (library) {\r\n    Mapkick.library = library;\r\n  };\r\n\r\n  // not ideal, but allows for simpler integration\r\n  if (typeof window !== \"undefined\" && !window.Mapkick) {\r\n    window.Mapkick = Mapkick;\r\n\r\n    // use setTimeout so mapping library can come later in same JS file\r\n    setTimeout(function () {\r\n      window.dispatchEvent(new Event(\"mapkick:load\"));\r\n    }, 0);\r\n  }\r\n\r\n  return Mapkick;\r\n\r\n}));"],"names":[],"version":3,"file":"index.40805586.js.map","sourceRoot":"/__parcel_source_root/"}